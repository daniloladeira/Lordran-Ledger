<div class="lordran-container">
  <header class="header">
    <div class="header-content">
      <h1 class="title">
        <i class="pi pi-book"></i>
        Lordran Ledger
      </h1>
      <p class="subtitle">Inventory Management System</p>
    </div>
  </header>

  <main class="main-content">
    <div class="toolbar">
      <p-button 
        label="Add New Item" 
        icon="pi pi-plus" 
        (onClick)="openNewItemDialog()"
        class="add-button">
      </p-button>
    </div>

    <div class="inventory-grid">
      <div class="item-card" *ngFor="let item of items">
        <div class="item-header">
          <div class="item-icon">
            <i [class]="getTypeIcon(item.type)"></i>
          </div>
          <div class="item-info">
            <h3 class="item-name" [class]="getRarityClass(item.rarity)">
              {{ item.name }}
            </h3>
            <span class="item-type">{{ item.type | titlecase }}</span>
          </div>
          <div class="item-status">
            <span class="equipped-badge" *ngIf="item.equipped">
              <i class="pi pi-check"></i> Equipped
            </span>
          </div>
        </div>

        <div class="item-stats">
          <div class="stat">
            <span class="stat-label">Value:</span>
            <span class="stat-value">{{ item.value }}</span>
          </div>
          <div class="stat">
            <span class="stat-label">Souls:</span>
            <span class="stat-value souls">{{ item.souls }}</span>
          </div>
          <div class="stat">
            <span class="stat-label">Rarity:</span>
            <span class="stat-value" [class]="getRarityClass(item.rarity)">
              {{ item.rarity | titlecase }}
            </span>
          </div>
        </div>

        <div class="item-description">
          {{ item.description }}
        </div>

        <div class="item-actions">
          <p-button 
            icon="pi pi-eye" 
            (onClick)="openDetailDialog(item)"
            class="p-button-text action-btn"
            pTooltip="View Details">
          </p-button>
          <p-button 
            icon="pi pi-pencil" 
            (onClick)="openEditDialog(item)"
            class="p-button-text action-btn"
            pTooltip="Edit Item">
          </p-button>
          <p-button 
            icon="pi pi-trash" 
            (onClick)="deleteItem(item)"
            class="p-button-text p-button-danger action-btn"
            pTooltip="Delete Item">
          </p-button>
        </div>
      </div>
    </div>
  </main>

  <!-- Add/Edit Dialog -->
  <p-dialog 
    [(visible)]="displayDialog" 
    [header]="isEditing ? 'Edit Item' : 'Add New Item'"
    [modal]="true" 
    [closable]="true"
    [style]="{width: '600px'}"
    styleClass="item-dialog">
    
    <div class="dialog-content">
      <div class="field">
        <label for="name">Name *</label>
        <input 
          id="name"
          type="text" 
          pInputText 
          [(ngModel)]="itemForm.name" 
          placeholder="Enter item name"
          class="w-full">
      </div>

      <div class="field-group">
        <div class="field">
          <label for="type">Type</label>
          <p-dropdown 
            id="type"
            [(ngModel)]="itemForm.type" 
            [options]="typeOptions"
            placeholder="Select type"
            class="w-full">
          </p-dropdown>
        </div>

        <div class="field">
          <label for="rarity">Rarity</label>
          <p-dropdown 
            id="rarity"
            [(ngModel)]="itemForm.rarity" 
            [options]="rarityOptions"
            placeholder="Select rarity"
            class="w-full">
          </p-dropdown>
        </div>
      </div>

      <div class="field-group">
        <div class="field">
          <label for="value">Value *</label>
          <p-inputNumber 
            id="value"
            [(ngModel)]="itemForm.value" 
            [min]="0"
            placeholder="0"
            class="w-full">
          </p-inputNumber>
        </div>

        <div class="field">
          <label for="souls">Souls *</label>
          <p-inputNumber 
            id="souls"
            [(ngModel)]="itemForm.souls" 
            [min]="0"
            placeholder="0"
            class="w-full">
          </p-inputNumber>
        </div>
      </div>

      <div class="field">
        <div class="checkbox-field">
          <p-checkbox 
            id="equipped"
            [(ngModel)]="itemForm.equipped" 
            [binary]="true">
          </p-checkbox>
          <label for="equipped">Currently Equipped</label>
        </div>
      </div>

      <div class="field">
        <label for="description">Description</label>
        <textarea 
          id="description"
          pInputTextarea 
          [(ngModel)]="itemForm.description" 
          rows="3"
          placeholder="Enter item description"
          class="w-full">
        </textarea>
      </div>
    </div>

    <ng-template pTemplate="footer">
      <p-button 
        label="Cancel" 
        icon="pi pi-times" 
        (onClick)="displayDialog = false"
        class="p-button-text">
      </p-button>
      <p-button 
        [label]="isEditing ? 'Update' : 'Save'" 
        icon="pi pi-check" 
        (onClick)="saveItem()">
      </p-button>
    </ng-template>
  </p-dialog>

  <!-- Detail Dialog -->
  <p-dialog 
    [(visible)]="displayDetailDialog" 
    header="Item Details"
    [modal]="true" 
    [closable]="true"
    [style]="{width: '600px'}"
    styleClass="detail-dialog"
    *ngIf="selectedItem">
    
    <div class="detail-content">
      <div class="detail-header">
        <div class="detail-icon">
          <i [class]="getTypeIcon(selectedItem.type)"></i>
        </div>
        <div>
          <h2 class="detail-name" [class]="getRarityClass(selectedItem.rarity)">
            {{ selectedItem.name }}
          </h2>
          <span class="detail-type">{{ selectedItem.type | titlecase }}</span>
        </div>
      </div>

      <div class="detail-stats">
        <div class="detail-stat">
          <span class="detail-label">Value:</span>
          <span class="detail-value">{{ selectedItem.value }}</span>
        </div>
        <div class="detail-stat">
          <span class="detail-label">Souls:</span>
          <span class="detail-value souls">{{ selectedItem.souls }}</span>
        </div>
        <div class="detail-stat">
          <span class="detail-label">Rarity:</span>
          <span class="detail-value" [class]="getRarityClass(selectedItem.rarity)">
            {{ selectedItem.rarity | titlecase }}
          </span>
        </div>
        <div class="detail-stat">
          <span class="detail-label">Status:</span>
          <span class="detail-value" [class]="selectedItem.equipped ? 'equipped' : 'unequipped'">
            {{ selectedItem.equipped ? 'Equipped' : 'Not Equipped' }}
          </span>
        </div>
      </div>

      <div class="detail-description">
        <h4>Description</h4>
        <p>{{ selectedItem.description || 'No description available.' }}</p>
      </div>
    </div>

    <ng-template pTemplate="footer">
      <p-button 
        label="Close" 
        icon="pi pi-times" 
        (onClick)="displayDetailDialog = false"
        class="p-button-text">
      </p-button>
    </ng-template>
  </p-dialog>
</div>

<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>
